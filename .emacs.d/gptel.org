* gptel for interacting with LLMs
** Installation
#+begin_src elisp :results none
(use-package gptel :load-path "~/repos/gptel/")
(setq gptel-default-mode 'org-mode)
(require 'gptel)
#+end_src
** Claude
#+begin_src elisp :results none
(require 'gptel-anthropic)
(setq
 gptel-model 'claude-sonnet-4-20250514
 gptel-backend
 (gptel-make-anthropic
     "Claude"
   :stream t
   :key (with-temp-buffer
	  (insert-file-contents "~/.anthropic-api-key.gpg")
	  (buffer-string))))
#+end_src
** Claude via Bedrock
Using Bedrock via an API key currently depends on [[https://github.com/karthink/gptel/pull/1053][this PR]].
#+begin_src elisp :results none
(when (file-exists-p "~/.bedrock-api-key.gpg")
  (require 'gptel-bedrock)
  (setq gptel-model   'claude-sonnet-4-20250514
	gptel-backend
	(gptel-make-bedrock "AWS"
	  :stream t
	  :region "us-east-1"
	  :models '(claude-sonnet-4-20250514)
	  :aws-bearer-token (with-temp-buffer
			     (insert-file-contents "~/.bedrock-api-key.gpg")
			     (buffer-string))
	  :model-region 'us)))
#+end_src
** Global key bindings
#+begin_src elisp :results none
(defun ak/gptel (name)
  (interactive
   (list
    (completing-read
     "Gptel session: "
     (seq-map #'buffer-name
	      (seq-filter
	       (lambda (b) (s-contains-p "*gptel" (buffer-name b)))
	       (buffer-list))))))
  (if (s-contains-p "*gptel" name)
    (switch-to-buffer (gptel name))
    (switch-to-buffer (gptel (format "*gptel %s*" name)))))

(global-set-key (kbd "C-x G g") #'ak/gptel)
(global-set-key (kbd "C-x G s") #'gptel-send)
#+end_src
